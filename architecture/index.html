



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.2.0">
    
    
      
        <title>Architecture - Hextech Friends Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.572ca0f0.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#e91e63">
      
    
    
      <script src="../assets/javascripts/modernizr.8c900955.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="pink" data-md-color-accent="purple">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#architecture" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Hextech Friends Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon">people_outline</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Hextech Friends Documentation
              </span>
              <span class="md-header-nav__topic">
                Architecture
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Hextech Friends Documentation" class="md-nav__button md-logo">
      
        <i class="md-icon">people_outline</i>
      
    </a>
    Hextech Friends Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../getting_started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../creating_a_lobby/" title="Creating a Lobby" class="md-nav__link">
      Creating a Lobby
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../joining_a_lobby/" title="Joining a Lobby" class="md-nav__link">
      Joining a Lobby
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../accepting_to_lobby/" title="Accepting a Player" class="md-nav__link">
      Accepting a Player
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Architecture
      </label>
    
    <a href="./" title="Architecture" class="md-nav__link md-nav__link--active">
      Architecture
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#server" title="Server" class="md-nav__link">
    Server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client" title="Client" class="md-nav__link">
    Client
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lcu-dataflow" title="LCU Dataflow" class="md-nav__link">
    LCU Dataflow
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../building/" title="Building" class="md-nav__link">
      Building
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../credits/" title="Credits" class="md-nav__link">
      Credits
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../legal/" title="Legal" class="md-nav__link">
      Legal
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../about/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#server" title="Server" class="md-nav__link">
    Server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client" title="Client" class="md-nav__link">
    Client
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lcu-dataflow" title="LCU Dataflow" class="md-nav__link">
    LCU Dataflow
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="architecture">Architecture</h1>
<p>Hextech Friends uses two components:</p>
<ol>
<li>A <a href="/Architecture#server">relay server</a> to enable clients to talk to each other</li>
<li>A <a href="/Architecture#client">client</a> to handle the connections to the LCU, as well as the user interface</li>
</ol>
<h2 id="server">Server</h2>
<p>The server accepts connections as a <strong>websocket server</strong>, since Hextech Friends requires bidirectional communication.
The server uses JSON to send data between client and server.</p>
<p>A sample protocol message looks like this:</p>
<pre><code class="json">{
    &quot;opCode&quot;: &quot;registerLobbyTS&quot;,
    &quot;summonerName&quot;: &quot;Cute Lux&quot;,
    &quot;level&quot;: 32,
    &quot;iconId&quot;: 1431,
    &quot;platform&quot;: &quot;EUW&quot;
}
</code></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Each opcode ends either with TS or TC, which means <code>to server</code> or <code>to client</code> respectively</p>
</div>
<p>The server's <strong>message handler</strong> tries to parse the JSON message, accesses only the "opCode" and calls the respective function.
After this, the called function parses the full JSON into a predefined model class, and sends everything to the LobbyManager.
The <strong>lobby manager</strong> manages all tasks like creating a <strong>lobby</strong>, requesting to join the lobby, or leaving again and sends information to clients if needed.</p>
<p>To illustrate the above: <br><br>
<img alt="Server Architecture Flowchart" src="/images/Hextech-Friends-Server.png" /></p>
<p>It's important to note here, that in some special cases the <strong>lobby</strong> doesn't return state to the <strong>lobby manager</strong>, but rather directly sends the information to the <strong>client</strong> via the <strong>websocket server</strong>. This happens for example in broadcast-packets like <code>LobbyClosedTC</code> (used to inform clients that the lobby owner closed the lobby).</p>
<h2 id="client">Client</h2>
<p>The client is built using Windows Presentation Framework (WPF). <br>
The client uses only one window, but different views to display all data.
Every view is a usercomponent. The client initializes each view directly on application startup, and keeps a reference to them in <strong>ViewModel</strong>. 
This type of architecture allows the client to switch back and forth between views without loosing state on them. </p>
<p>In addition to this, the client maintains a class connecting every part of the app, called <strong>AppManager</strong>. Using this, all views have direct access to each other, and have the possibility of storing information which can be accessed by other views and services.</p>
<p>Services (e.g. <strong>Hextech socket</strong>) are used for keeping the connection to the <strong>server</strong>, as well as to the LCU.</p>
<p>And again an illustration of the above: <br><br>
<img alt="Client Architecture" src="/images/Hextech-Friends-Client.png" /></p>
<p>Here it is important to note that every view interacts with the other components based on user input, but for readability of the flowchart, this is omitted here.</p>
<h2 id="lcu-dataflow">LCU Dataflow</h2>
<p>The client itself is only able to connect to the LCU after it is already running, since it is meant as an extension to the LCU, and not to replace any functionality.
Hextech Friends connects to the LCU websocket to listen for <code>lol-lobby/v2/lobby</code> create and delete events, to switch to Hextech Friends CreateLobbyView, and to close lobbies.
Aside from that it uses <code>lol-lobby/v2/lobby/invitations</code> to invite summoners after they are accepted by the owner and <code>lol-summoner/v1/current-summoner/</code> for both requesting to join a lobby and creating a lobby. This is needed to get the summoner name, summoner id and profile icon. Summoner name and profile icon are displayed in Hextech Friends. The summoner id is used to send the invitation via the League client after someone was accepted.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../accepting_to_lobby/" title="Accepting a Player" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Accepting a Player
              </span>
            </div>
          </a>
        
        
          <a href="../building/" title="Building" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Building
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.b41f3d20.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>